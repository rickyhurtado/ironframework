// data.view.min.js v1.0
define(["category_model","init_module","core_module"],function(d){return Backbone.View.extend({initialize:function(){console.log("Backbone.View.DataView has been initialized.");this.category=I.Init.Collections.Category;this.contacts=I.Init.Collections.Contacts;this.category.fetch();this.contacts.fetch();console.log("Fetch categories and contacts from local storage data.")},target:{mainContent:"#main-content",dataPage:"#data-page",dataContent:"#data-content",categoryContent:"#category-list-content", contactsContent:"#contacts-list-content",relatedContent:".data-content"},template:{dataPage:new EJS({url:I.JsPath+"/module/data/template/"+I.JsVersion+"/data-page."+I.JsVersion+".html"}),category:new EJS({url:I.JsPath+"/module/data/template/"+I.JsVersion+"/category."+I.JsVersion+".html"}),contacts:new EJS({url:I.JsPath+"/module/data/template/"+I.JsVersion+"/contacts."+I.JsVersion+".html"})},renderDataPage:function(){$(this.target.mainContent).append(this.template.dataPage.render({}))},renderCategory:function(a){var b= I.Data.View,c=b.target.categoryContent;$(c).html(b.template.category.render({categories:a}));I.Core.Controller.enableObjectRoute(["contacts-category"]);I.Core.Controller.showContent({el:c,rel:b.target.relatedContent})},displayCategory:function(){var a=null;console.log("[START MANAGING COLLECTION AND MODEL] ==================================================================");a=this.category.get(2);void 0!=a&&(console.log("Get the Business category by ID:\n\t"+a.get("category")),a.save({category:"Business"})); a=this.category.find(function(a){return 3==a.get("category_id")});void 0!=a&&console.log("Get the Business category by category_id:\n\t"+a.get("category"));a=this.category.where({status:1});console.log("Get the categories by where function:\n[ARRAY RETURN] "+JSON.stringify(this.category.where({status:1}))+"\nCategory list:");_.map(a,function(a,c){console.log("\t"+(c+1)+". "+a.get("category"))});a=this.category.findWhere({status:1});void 0!=a&&console.log("Get the categories by findWhere function:\n\t"+ a.get("category"));this.addCategory({category:"Ironman",fragment:"ironman"});this.removeCategory(5);console.log("[END MANAGING COLLECTION AND MODEL] ====================================================================");this.renderCategory(this.category.models)},sortCategoryBy:function(a,b){this.category.comparator=function(c){return"desc"==b?-c.get(a):c.get(a)};this.category.sort({sort:!0})},addCategory:function(a){this.sortCategoryBy("id");a.id=this.category.newId();a.order=this.category.newOrder(); this.category.create(new d(a));this.sortCategoryBy("order")},removeCategory:function(a){var b=null,b=this.category.get(a);void 0!=b&&b.destroy({success:function(a){console.log('Destroy a category model:\n"'+a.get("category")+'" category has been destroyed!')}})},renderContacts:function(a){var b,c;(b=this.category.find(function(b){return b.get("fragment")==a}))&&$("#contacts-list-page .category-title").text(b.get("category"));this.contacts.comparator=function(a){return a.get("firstname")};this.contacts.sort({sort:!0}); b&&(c=this.contacts.where({category_id:b.get("category_id")}));return this.template.contacts.render({contacts:c,category:a})},displayContacts:function(a){var b=this.target.contactsContent;$(b).html(this.renderContacts(a));I.Core.Controller.enableObjectRoute([a+"-info"]);I.Core.Controller.showContent({el:b,rel:this.target.relatedContent})}})});